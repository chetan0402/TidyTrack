{
  "openapi": "3.0.3",
  "info": {
    "title": "TidyTrack",
    "version": "v1"
  },
  "servers": [
    {
      "url": "http://tt.manit.ac.in"
    }
  ],
  "paths": {
    "/": {
      "get":{
        "description": "Main landing page",
        "responses": {
          "200":{
            "description":"Landing page is served"
          }
        }
      },
      "post": {
        "description": "Submitting the form data",
        "requestBody": {
          "required":true,
          "content":{
            "application/json": {
              "schema":{
                "type":"object",
                "properties":{
                  "token":{
                    "type":"string",
                    "description":"Auth token"
                  },
                  "name":{
                    "type":"string",
                    "description":"Feedback",
                    "default":""
                  },
                  "rad":{
                    "type":"integer",
                    "description":"radio button",
                    "default":0
                  },
                  "washroom":{
                    "type":"string",
                    "description":"location code",
                    "example":"H10CG1"
                  },
                  "img":{
                    "type":"string",
                    "description":"base64 encoded image"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The response was submited"
          },
          "403":{
            "description": "Authentication Failed"
          },
          "429":{
            "description": "Rate limit hit"
          },
          "500":{
            "description": "internal server error"
          }
        }
      }
    },
    "/chart":{
      "post":{
        "description":"Chart API point",
        "parameters":[
          {
            "name":"Auth",
            "in":"cookie",
            "required":true,
            "schema":{
              "type":"string"
            }
          },
          {
            "name":"fromDate",
            "in":"query",
            "required":true,
            "description":"unix timestamp value",
            "schema":{
              "type":"integer"
            }
          },
          {
            "name":"toDate",
            "in":"query",
            "required":true,
            "description":"unix timestamp value",
            "schema":{
              "type":"integer"
            }
          },
          {
            "name":"washroomCode",
            "in":"query",
            "required":false,
            "description":"location code",
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses": {
          "200":{
            "description":"PNG returned"
          },
          "400":{
            "description":"Required parameter not present"
          },
          "403":{
            "description":"Authenticaiton Failed"
          },
          "500":{
            "description":"Internal server error"
          }
        }
      }
    },
    "/admin/verify":{
      "post":{
        "description":"Get token for admin",
        "requestBody":{
          "content":{
            "application/x-www-form-urlencoded": {
              "schema":{
                "type":"object",
                "properties":{
                  "user":{
                    "type":"string"
                  },
                  "pswd":{
                    "type":"string"
                  }
                }
              }
            }
          }
        },
        "responses":{
          "200":{
            "description":"token returned as cookie"
          },
          "401":{
            "description": "wrong userpass"
          },
          "500":{
            "description":"internal server error"
          }
        }
      }
    },
    "/get/locations":{
      "get":{
        "responses":{
          "200":{
            "description":"JSON",
            "content":{
              "application/json":{
                "schema":{
                  "type":"object",
                  "properties":{
                    "Hostel 10CD":{
                      "type":"object",
                      "properties":{
                        "G1 Near 008":{
                          "type":"string",
                          "default":"H10CG1"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/download":{
      "get":{
        "responses":{
          "200":{
            "description":"APK file",
            "content":{
              "application/vnd.andoird.package-archive":{
              }
            }
          }
        }
      }
    },
    "/reload":{
      "post":{
        "parameters":[
          {
            "name":"Auth",
            "in":"cookie",
            "required":true,
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses":{
          "200":{
            "description":"config has been reloaded"
          },
          "403":{
            "description":"Token rejected"
          }
        }
      }
    },
    "/get/table":{
      "post":{
        "parameters":[
          {
            "name":"fromDate",
            "in":"query",
            "required":true,
            "schema":{
              "type":"integer"
            }
          },
          {
            "name":"toDate",
            "in":"query",
            "required":true,
            "schema":{
              "type":"integer"
            }
          },
          {
            "name":"washroomCode",
            "in":"query",
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses":{
          "200":{
            "description":"",
            "content":{
              "text/plain": {
                "schema":{
                  "type":"string",
                  "example":"[[12412,'feedback','imgpack','rating','locationcode',10002398]]"
                }
              }
            }
          },
          "403":{
            "description":"Token rejected"
          }
        }
      }
    },
    "/img/{path}":{
      "get":{
        "parameters":[
          {
            "name":"Auth",
            "in":"cookie",
            "required":true,
            "schema":{
              "type":"string"
            }
          },
          {
            "name":"path",
            "in":"path",
            "required":true,
            "schema":{
              "type":"string"
            }
          }
        ],
        "responses":{
          "200":{
            "description":"PNG returned"
          },
          "403":{
            "description":"Token rejected"
          }
        }
      }
    },
    "/otp/send":{
      "post":{
        "requestBody":{
          "content":{
            "application/json":{
              "schema":{
                "type":"object",
                "properties":{
                  "sch_no":{
                    "type":"integer",
                    "reqiured":true
                  },
                  "stud_name":{
                    "type":"string"
                  },
                  "phone_no":{
                    "type":"integer"
                  }
                }
              }
            }
          }
        },
        "responses":{
          "200":{
            "description":"OTP sent",
            "content":{
              "text/plain":{
                "example":"1234567890"
              }
            }
          },
          "400":{
            "description":"Wrong argument sent"
          },
          "429":{
            "description":"Rate limited"
          }
        }
      }
    },
    "/otp/verify":{
      "post":{
        "requestBody":{
          "content":{
            "application/json":{
              "schema":{
                "type":"object",
                "properties":{
                  "sch_no":{
                    "type":"integer"
                  },
                  "otp":{
                    "type":"integer"
                  }
                }
              }
            }
          }
        },
        "responses":{
          "200":{
            "description": "token generated",
            "content":{
              "text/plain":{
                "example":"wetc2iuhtc28cbtwejkt"
              }
            }
          },
          "401":{
            "description":"Wrong OTP"
          }
        }
      }
    },
    "/update":{
      "post":{
        "parameters":[
          {
            "name":"version",
            "in":"query",
            "schema":{
              "type":"integer"
            }
          }
        ],
        "responses":{
        "100":{
          "description":"Your app is updated"
        },
        "200":{
          "description":"Update your app"
        }
      }
      }
    }
  }
}
